<head>
  <style> body { margin: 0; } </style>

  <script src="https://unpkg.com/3d-force-graph"></script>
</head>

<body>
  <div id="graph"></div>

  <script>
    fetch('out_clean.json').then(res => res.json()).then(data => {

      const elem = document.getElementById('graph');

      const Graph = ForceGraph3D()(elem)
        .backgroundColor('#101020')
        .nodeAutoColorBy('time')
        .nodeLabel(node => `${node.note}`)
        .linkColor(() => 'rgba(255,255,255,0.2)')
        .graphData(data)
        .zoomToFit();

      //   Graph.onNodeDrag(() => Graph.cooldownTicks(0))
      //   var time = 1630509635000 

      //   var interval = setInterval(() => {
      //     console.log(time)
      //     set = new Set();

      //     var finalObj = {nodes: [], links: []}
      //     data['nodes'].forEach(i => { 
      //       if (i.time < time) {
      //         finalObj['nodes'].push(i);
      //         set.add(i.id)
      //       }
      //     })
      //     data['links'].forEach(i => {
      //       if (set.has(i.source) && set.has(i.target)) {
      //         finalObj['links'].push({source: i.source, target: i.target});
      //       }
      //     });
      //     Graph.graphData(finalObj)
      //     time += 7*86400000
      //     if (time > 1641284246702) {
      //       clearInterval(interval)
      //     }
      //   }, 1000)
      });

  </script>
</body>